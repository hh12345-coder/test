from openpyxl import Workbook

# 创建工作簿和工作表
wb = Workbook()
ws = wb.active

# 设置表头
headers = ['星期', '开始时间', '结束时间', '课程', '教学周']
ws.append(headers)

# 添加用户提供的课程（无教学周，测试默认周次功能）
courses = [
    ['周一', '08:00', '10:00', '高等数学', ''],
    ['周一', '10:10', '12:00', '大学英语', ''],
    ['周二', '09:00', '11:00', '线性代数', ''],
    ['周三', '13:00', '15:00', '计算机基础', ''],
    ['周四', '08:30', '10:00', '体育', ''],
    ['周五', '14:00', '16:00', '概率论', '']
]

# 添加一些有明确教学周的课程（测试周次解析功能）
extra_courses = [
    ['周二', '14:00', '16:00', '物理实验', '1-8'],
    ['周三', '10:00', '12:00', '数据结构', '5-14'],
    ['周四', '14:00', '15:30', '数据库原理', '1,3,5,7,9'],
    ['周五', '08:00', '09:30', '操作系统', '10-16']
]

# 将所有课程添加到工作表
for course in courses + extra_courses:
    ws.append(course)

# 保存文件
wb.save('test_valid_schedule.xlsx')
print("✅ 课表文件创建成功: test_valid_schedule.xlsx")
print("\n文件包含:")
print("- 6门无教学周的课程（测试默认1-16周功能）")
print("- 4门有明确教学周的课程（测试周次解析功能）")
